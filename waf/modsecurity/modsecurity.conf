SecRuleEngine On
SecRequestBodyAccess On
SecResponseBodyAccess Off

# Logging
SecAuditEngine RelevantOnly
SecAuditLog /var/log/modsecurity/audit.log
SecAuditLogFormat JSON

# Request limits
SecRequestBodyLimit 13107200
SecRequestBodyNoFilesLimit 131072

# Paranoia level (low false positives)
SecAction \
  "id:900000,\
   phase:1,\
   pass,\
   nolog,\
   setvar:tx.paranoia_level=1"

# Unicode support
SecUnicodeMapFile unicode.mapping 20127

# Load OWASP CRS
Include /etc/nginx/modsecurity/crs-setup.conf
Include /etc/nginx/modsecurity/rules/*.conf

